<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Welsh Preposition Trainer</title>

  <!-- Tailwind via CDN -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- Your site CSS (buttons/panels/etc.) -->
  <link rel="stylesheet" href="styles.css" />
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Abril+Fatface&family=Inconsolata:wght@200;300&family=Josefin+Sans:wght@300;400&family=Karla:wght@200;300;500;600&family=Merriweather:ital,wght@1,900&family=Poppins:ital,wght@0,100;0,200;0,400;1,100&family=Slabo+13px&family=Slabo+27px&family=Ultra&family=Yeseva+One&display=swap');
  </style>
  <!-- PapaParse for CSV loading -->
  <script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js" defer></script>

  <!-- Shared navbar loader (must fetch navbar.html) -->
  <script src="navbar.js" defer></script>

  <!-- Page logic -->
  <script src="prep.js" defer></script>

  <style>
    
    .prep-choice {
      border: 1px solid rgb(226 232 240);
      background: white;
      border-radius: 9999px;
      padding: 0.85rem 1rem;
      font-weight: 600;
      color: rgb(15 23 42);
      transition: transform .05s ease, background .15s ease, border-color .15s ease;
    }
    .prep-choice:hover { background: rgb(248 250 252); border-color: rgb(203 213 225); }
    .prep-choice:active { transform: translateY(1px); }
    .prep-choice.is-on {
      background: rgb(16 185 129 / 0.15);
      border-color: rgb(16 185 129 / 0.35);
      color: rgb(6 95 70);
    }
    .prep-gap {
      display: inline-flex;
      align-items: baseline;
      justify-content: center;
      min-width: 5.5rem;
      padding: 0.35rem 0.9rem;
      border-radius: 1rem;
      border: 1px solid rgb(148 163 184);
      background: rgb(255 251 235);
      font-weight: 800;
      position: relative; /* anchor the red ? button */
      line-height: 1.2;
    }
    .prep-helpkeys kbd {
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      font-size: 0.75rem;
      padding: 0.1rem 0.35rem;
      border-radius: 0.5rem;
      border: 1px solid rgb(226 232 240);
      background: rgb(248 250 252);
      color: rgb(71 85 105);
    }
  </style>
</head>

<body class="min-h-screen text-slate-900">
  <!-- Navbar mount (navbar.js should populate this from navbar.html) -->
  <div id="navbar"></div>

  <main class="max-w-6xl mx-auto p-4 pb-24 md:pb-6">
    <div class="mt-4 md:mt-6">
      <h1 class="text-4xl md:text-5xl font-extrabold tracking-tight">
        <span class="text-emerald-900">PREPOSITION</span><span class="text-rose-700">TRAINER</span>
      </h1>
      <p id="prepIntro" class="mt-2 text-slate-600 max-w-3xl">
        Choose the Welsh preposition that matches the English sentence. Switch to <b>Hard</b> to type instead of picking.
      </p>
    </div>

    <section class="mt-6 grid md:grid-cols-3 gap-4 items-start">
      <!-- Left: question card -->
      <div class="md:col-span-2 panel rounded-2xl p-5 md:p-6">
        <!-- Top row: progress + actions -->
        <div class="flex flex-wrap items-center justify-between gap-2 mb-4">
          <div class="text-sm text-slate-600">
            <span id="prepProgress">Card 0 / 0</span>
            <span class="mx-2 text-slate-300">•</span>
            <span id="prepMeta">—</span>
          </div>

          <div class="flex items-center gap-2 flex-wrap">
            <!-- Difficulty toggle uses your existing seg styles if present -->
            <div class="seg" aria-label="Difficulty">
              <button id="btnEasy" type="button" class="seg-btn is-on" aria-pressed="true">EASY</button>
              <button id="btnHard" type="button" class="seg-btn" aria-pressed="false">HARD</button>
            </div>

            <button id="btnHint" class="btn btn-ghost" type="button" title="Hint (H)">Hint</button>
            <button id="btnHear" class="btn btn-ghost" type="button" title="Hear (J)">Hear</button>
            <button id="btnReveal" class="btn btn-ghost" type="button" title="Reveal (R)">Reveal</button>
            <button id="btnNext" class="btn btn-primary shadow" type="button" title="Next (Enter)">Next</button>
          </div>
        </div>

        <!-- Load error -->
        <div id="loadError" class="hidden mb-4 rounded-xl border border-rose-200 bg-rose-50 p-4 text-rose-900">
          <div class="font-semibold">Couldn’t load data.</div>
          <div id="loadErrorMsg" class="text-sm mt-1"></div>
        </div>

        <!-- English target sentence (clean, no label) -->
        <div class="rounded-2xl border border-emerald-200 bg-emerald-50 p-4 md:p-5">
          <div id="enSentence" class="text-xl md:text-2xl font-semibold text-slate-900">
            —
          </div>
        </div>

        <!-- Welsh sentence -->
        <div class="mt-4 rounded-2xl border border-slate-200 bg-white p-4 md:p-5">
          <div class="text-xs uppercase tracking-wide text-slate-500 mb-2">Cymraeg</div>

          <div class="text-2xl md:text-3xl leading-snug flex flex-wrap items-baseline gap-x-2 gap-y-2">
            <span id="cyBefore" class="text-slate-700"></span>
            <span id="cyGap" class="prep-gap">____</span>
            <span id="cyAfter" class="text-slate-700"></span>
          </div>

          <div id="hintBox" class="hidden mt-3 text-sm text-slate-600">
            <span class="font-semibold">Hint:</span>
            <span id="hintText"></span>
          </div>

          <!-- Hard mode input -->
          <div id="hardInputRow" class="hidden mt-4 flex flex-wrap items-center gap-2">
            <input id="hardInput"
                   class="border-2 border-slate-300 focus:border-cyan-600 outline-none bg-amber-50 px-3 py-2 rounded-xl text-xl md:text-2xl leading-tight shadow-sm w-56"
                   placeholder="Type the answer…"
                   aria-label="Type the answer" />
            <button id="btnCheck" class="btn btn-primary shadow" type="button">Check</button>
          </div>

          <!-- Easy mode choices -->
          <div id="choicesRow" class="mt-4 grid grid-cols-2 md:grid-cols-4 gap-3"></div>

          <!-- Feedback -->
          <div id="feedbackBox" class="hidden mt-5 rounded-2xl border p-4 md:p-5">
            <div id="fbHeadline" class="text-xl md:text-2xl font-bold"></div>
            <div id="fbBody" class="mt-2 text-slate-700 leading-relaxed"></div>
          </div>

          <div class="prep-helpkeys mt-4 text-xs text-slate-500">
            Keys:
            <kbd>1</kbd> <kbd>2</kbd> <kbd>3</kbd> <kbd>4</kbd>
            <span class="mx-1">•</span>
            <kbd>H</kbd> Hint
            <span class="mx-1">•</span>
            <kbd>R</kbd> Reveal
            <span class="mx-1">•</span>
            <kbd>Enter</kbd> Next / Check (Hard)
          </div>
        </div>
      </div>

      <!-- Right: filters + session -->
      <aside class="md:col-span-1 flex flex-col gap-4">
        <div class="panel rounded-2xl p-4">
          <div class="text-sm font-medium mb-3">Filters</div>

          <label class="block text-xs uppercase tracking-wide text-slate-500 mb-1" for="fLevel">Level</label>
          <select id="fLevel" class="w-full border rounded-xl px-3 py-2 bg-white">
            <option>All</option>
          </select>

          <label class="mt-3 block text-xs uppercase tracking-wide text-slate-500 mb-1" for="fTopic">Topic</label>
          <select id="fTopic" class="w-full border rounded-xl px-3 py-2 bg-white">
            <option>All</option>
          </select>

          <label class="mt-3 block text-xs uppercase tracking-wide text-slate-500 mb-1" for="fFocus">Focus (answer)</label>
          <select id="fFocus" class="w-full border rounded-xl px-3 py-2 bg-white">
            <option>All</option>
          </select>

          <div class="mt-3 flex items-center justify-between gap-2">
            <button id="btnClearFilters" class="btn btn-ghost px-3 py-2" type="button">Clear</button>
            <div class="text-xs text-slate-500"><span id="poolCount">0</span> items</div>
          </div>
        </div>

        <div class="panel rounded-2xl p-4">
          <div class="text-sm font-medium mb-3">Session</div>

          <div class="grid grid-cols-3 gap-2">
            <div class="rounded-xl border border-slate-200 bg-white p-3">
              <div class="text-xs text-slate-500">Score</div>
              <div id="statScore" class="text-2xl font-bold">0</div>
            </div>
            <div class="rounded-xl border border-slate-200 bg-white p-3">
              <div class="text-xs text-slate-500">Streak</div>
              <div id="statStreak" class="text-2xl font-bold">0</div>
            </div>
            <div class="rounded-xl border border-slate-200 bg-white p-3">
              <div class="text-xs text-slate-500">Done</div>
              <div id="statDone" class="text-2xl font-bold">0</div>
            </div>
          </div>

          <div class="mt-3 text-sm text-slate-600">
            <span class="font-medium">Accuracy:</span> <span id="statAcc">0%</span>
          </div>

          <div class="mt-3 flex gap-2">
            <button id="btnResetStats" class="btn btn-ghost px-3 py-2" type="button">Reset stats</button>
          </div>
        </div>
      </aside>
    </section>
  </main>
</body>
</html>

